         tempbdry=crse(ic,jc,kc)
         do dirtan=0,SDIM-1
          if (dirtan.ne.dir) then
           ii=0
           jj=0
           kk=0
           if (dirtan.eq.0) then
            ii=1
           else if (dirtan.eq.1) then
            jj=1
           else if ((dirtan.eq.2).and.(SDIM.eq.3)) then
            kk=1
           else
            print *,"dirtan invalid"
            stop
           endif
           lplus=crsels(ic+ii,jc+jj,kc+kk)
           lminus=crsels(ic-ii,jc-jj,kc-kk)
           lcen=crsels(ic,jc,kc)
           slopeplus=(crse(ic+ii,jc+jj,kc+kk,n)-crse(ic,jc,kc,n))
           slopeminus=(crse(ic,jc,kc,n)-crse(ic-ii,jc-jj,kc-kk,n))
           slopecen=half*(slopeplus+slopeminus)
           minusflag=1
           plusflag=1
           if (mask(i-ii,j-jj,k-kk).ne.not_covered) then 
            minusflag=0
           endif
           if (mask(i+2*ii,j+2*jj,k+2*kk).ne.not_covered) then 
            plusflag=0
           endif
           if (((lminus.lt.zero).and.(lcen.ge.zero)).or.
     &         ((lminus.ge.zero).and.(lcen.lt.zero))) then
            minusflag=0
           endif
           if (((lplus.lt.zero).and.(lcen.ge.zero)).or.
     &         ((lplus.ge.zero).and.(lcen.lt.zero))) then
            plusflag=0
           endif
           if ((minusflag.eq.1).and.(plusflag.eq.1)) then
            slope=slopecen
           else if (minusflag.eq.1) then
            slope=slopeminus
           else if (plusflag.eq.1) then
            slope=slopeplus
           else
            slope=zero
           endif
           tempbdry=tempbdry+theta(dirtan)*slope
          endif
         enddo
c dirtan
         bdry(i,j,k,n)=tempbdry
